# Metasploit Search Notes

## General search syntax

```
search <keyword>
search type:<auxiliary|exploit> <keyword>
search platform:<windows|linux|unix>
search cve:<cve-id>
search <keyword1> <keyword2>
```

### `<keyword>` examples

Service / protocol keywords:

```
rdp
smb
http
ftp
ssh
ldap
mysql
mssql
```

Vulnerability / exploit names:

```
bluekeep
eternalblue
shellshock
heartbleed
log4j
printnightmare
zerologon
```

OS / platform keywords:

```
windows
linux
unix
multi
```

Module function keywords:

```
scanner
auth
login
enum
version
```

Combined keyword examples:

```
search smb scanner
search rdp windows
search http cgi
search smb auth
```

Common filters:

* `type:` auxiliary / exploit
* `platform:` target OS
* `rank:` excellent, great, good
* `cve:` CVE mapping

---

## RDP / BlueKeep (CVE-2019-0708)

### Discover RDP modules

```
search rdp
```

### Auxiliary scanners

```
search type:auxiliary rdp
search type:auxiliary rdp scanner
```

### BlueKeep-specific search

```
search bluekeep
search cve:2019-0708
search type:auxiliary cve:2019-0708
```

### Scanner module

```
use auxiliary/scanner/rdp/cve_2019_0708_bluekeep
```

### Exploit search

```
search type:exploit rdp
search type:exploit cve:2019-0708
```

### Exploit module

```
use exploit/windows/rdp/cve_2019_0708_bluekeep_rce
```

---

## SMB / EternalBlue (MS17-010, CVE-2017-0144)

### Discover SMB modules

```
search smb
```

### Auxiliary scanners

```
search type:auxiliary smb
search type:auxiliary smb scanner
```

### Vulnerability-specific search

```
search ms17-010
search eternalblue
search cve:2017-0144
```

### Scanner module

```
use auxiliary/scanner/smb/smb_ms17_010
```

### Exploit search

```
search type:exploit smb
search type:exploit ms17-010
```

### Exploit module

```
use exploit/windows/smb/ms17_010_eternalblue
```

---

## HTTP / Shellshock (CVE-2014-6271)

### Discover HTTP modules

```
search http
```

### Auxiliary scanners

```
search type:auxiliary http
search type:auxiliary cgi
```

### Vulnerability-specific search

```
search shellshock
search cve:2014-6271
search type:auxiliary shellshock
```

### Scanner module

```
use auxiliary/scanner/http/apache_mod_cgi_bash_env
```

### Exploit search

```
search type:exploit shellshock
search type:exploit http cgi
```

### Exploit module (example)

```
use exploit/multi/http/apache_mod_cgi_bash_env_exec
```

---

## Translating Nmap output → MSF keywords

Use Nmap service names, ports, and banners to derive Metasploit search keywords.

### Common translations

Nmap service / output → MSF keyword:

```
ms-wbt-server (3389)        → rdp
microsoft-ds (445)         → smb
netbios-ssn (139)          → smb
http / https               → http
Apache httpd               → http apache
nginx                      → http nginx
ssl/http                   → http ssl
ftp                         → ftp
ssh                         → ssh
ldap                        → ldap
mysql                      → mysql
ms-sql-s                    → mssql
```

### OS inference

```
Windows 7 / Server 2008    → windows
Linux kernel / distro      → linux
Unix-like                  → unix
```

### Vulnerability hints from Nmap scripts

```
SMB signing disabled       → smb auth
RDP NLA not required       → rdp
HTTP CGI detected          → http cgi
Outdated OpenSSL           → ssl
```

### Example translations

```
Nmap: 3389/tcp open ms-wbt-server
→ search rdp
→ search type:auxiliary rdp

Nmap: 445/tcp open microsoft-ds (Windows 7)
→ search smb windows
→ search type:auxiliary smb

Nmap: Apache httpd + CGI
→ search http cgi
→ search shellshock
```

---

## Standard workflow pattern (Nmap → MSF)

```
search <service>
search type:auxiliary <service>
search cve:<id>
use auxiliary/...
search type:exploit <service>
search type:exploit cve:<id>
use exploit/...
```

---

## Interpreting results (quick cues)

* Auxiliary exists → vulnerability is detectable
* Exploit exists → vulnerability is weaponized
* Few exploits → fragile / kernel-level
* Many exploits → mature / repeatable
* Scanner without exploit → unsafe or unreliable exploitation

---

## Notes

* Always read `info` before using any module
* Absence of scanners or exploits is meaningful data
* Use auxiliary modules for validation; exploit modules for understanding capability
